package lecture15absTypes;

class Book {
  String title;
  String author;
  int price;
  
  Book(String title, String author, int price) {
    this.title = title;
    this.author = author;
    this.price = price;
  }
}

interface IPred<T> {
  boolean apply(T t);
}

class BookByAuthor implements IPred<Book> {

  public boolean apply(Book b) {
    return false;
  }
  
}

interface IComparator<T> {
  int compare(T t1, T t2);
}

interface IList<T> {
  IList<T> filter(IPred<T> pred);
  IList<T> sort(IComparator<T> comp);
  IList<T> insert(IComparator<T> comp, T t);
  int length();
  
}

// “An MtList of T is a list of T.” 
class MtList<T> implements IList<T> {
  
  public IList<T> filter(IPred<T> pred) {
    return this;
  }

  public IList<T> sort(IComparator<T> comp) {
    return this;
  }

  public IList<T> insert(IComparator<T> comp, T t) {
    return new ConsList<T>(t, this);
  }

  public int length() {
    return 0;
  }

}

class ConsList<T> implements IList<T> {
  T first;
  IList<T> rest;
  
  ConsList(T first, IList<T> rest) {
    this.first = first;
    this.rest = rest;
  }
  
  public IList<T> filter(IPred<T> pred) {
    if (pred.apply(this.first)) {
      return new ConsList<T>(this.first, this.rest.filter(pred));
    }
    return this.rest.filter(pred);
  }

  public IList<T> sort(IComparator<T> comp) {
    return this.rest.sort(comp).insert(comp, this.first);
  }

  public IList<T> insert(IComparator<T> comp, T t) {
    if (comp.compare(t, this.first) < 0) {
      return new ConsList<T>(t, this);
    }
    return new ConsList<T>(this.first, this.rest.insert(comp, t));
  }

  public int length() {
    return 1 + this.length();
  }
}
